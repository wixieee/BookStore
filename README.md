# BookStore

## Опис проекту
BookStore - це веб-додаток для управління книжковим магазином. Система підтримує різні ролі користувачів (Клієнт, Працівник), дозволяє переглядати каталог книг, керувати кошиком, оформлювати замовлення та керувати обліковими записами.

## Основний функціонал
- **Автентифікація та Авторизація**: Реєстрація та вхід для клієнтів та працівників.
- **Каталог книг**: Перегляд доступних книг, пошук та фільтрація.
- **Кошик**: Додавання книг до кошика, зміна кількості, видалення.
- **Замовлення**: Оформлення замовлення, перегляд історії замовлень.
- **Управління користувачами**: Редагування профілю, блокування користувачів (для працівників).
- **Багатомовність**: Підтримка української та англійської мов.

## Структура проекту
Проект побудований за класичною тришаровою архітектурою:

- `com.epam.rd.autocode.spring.project`
    - `aspect`: Аспекти для логування.
    - `conf`: Конфігураційні класи (Security, Web, JWT).
    - `controller`: MVC контролери для обробки HTTP запитів.
    - `dto`: Об'єкти передачі даних для обміну даними між шарами.
    - `exception`: Кастомні виключення.
    - `model`: Сутності бази даних та Enums.
    - `repo`: Інтерфейси репозиторіїв для доступу до бази даних.
    - `service`: Інтерфейси та реалізація бізнес-логіки.

- `src/main/resources`
    - `sql`: SQL скрипт для ініціалізації бази даних (`sql.sql`).
    - `static`: Статичні ресурси (CSS стилі, зображення, JavaScript файли).
    - `templates`: HTML шаблони Thymeleaf.
    - `application.properties`: Головний конфігураційний файл додатку.
    - `messages_*.properties`: Файли локалізації для підтримки різних мов.

- `src/test`
    - `java`: Unit тести для перевірки функціоналу сервісів та контролерів.

## Як запустити
1. **Клонування репозиторію**:
   ```bash
   git clone https://github.com/wixieee/BookStore.git
   ```
2. **Збірка проекту**:
   ```bash
   mvn clean install
   ```
3. **Запуск**:
   ```bash
   mvn spring-boot:run
   ```
   Або запустіть клас `BookStoreServiceSolutionApplication.java` з вашої IDE.

4. **Доступ до додатку**:
   Відкрийте браузер та перейдіть за адресою: `http://localhost:8080`

## База даних
Використовується in-memory база даних H2.
Консоль H2 доступна за адресою: `http://localhost:8080/h2-console`
- **JDBC URL**: `jdbc:h2:mem:bookstore`
- **User**: `sa`
- **Password**: `sa`

## API Endpoints & Права доступу

Нижче наведено детальний опис усіх доступних URL-шляхів (endpoints), згрупованих за функціоналом.

### Автентифікація
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/login` | Сторінка входу | Всі |
| `POST` | `/login` | Обробка входу | Всі |
| `POST` | `/logout` | Вихід з системи | Всі |
| `GET` | `/client/register` | Сторінка реєстрації | Всі |
| `POST` | `/client/register` | Обробка реєстрації | Всі |

### Головна та Книги
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/` | Головна сторінка з каталогом книг | Всі |
| `GET` | `/book/{name}/{author}` | Детальна інформація про книгу | Всі |

### Кошик
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/cart` | Перегляд кошика | `ROLE_CLIENT` |
| `POST` | `/cart/add` | Додати книгу до кошика | `ROLE_CLIENT` |
| `POST` | `/cart/update` | Оновити кількість книг | `ROLE_CLIENT` |
| `POST` | `/cart/remove` | Видалити книгу з кошика | `ROLE_CLIENT` |
| `POST` | `/cart/clear` | Очистити кошик | `ROLE_CLIENT` |

### Профіль
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/profile/client` | Перегляд профілю клієнта | `ROLE_CLIENT` |
| `POST` | `/profile/client/update` | Оновлення профілю | `ROLE_CLIENT` |
| `POST` | `/profile/client/delete` | Видалення акаунту | `ROLE_CLIENT` |
| `GET` | `/profile/employee` | Перегляд профілю працівника | `ROLE_EMPLOYEE` |
| `POST` | `/profile/employee/update` | Оновлення профілю | `ROLE_EMPLOYEE` |
| `POST` | `/profile/employee/delete` | Видалення акаунту | `ROLE_EMPLOYEE` |

### Замовлення
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `POST` | `/orders/create` | Створити замовлення | `ROLE_CLIENT` |
| `GET` | `/orders/client` | Історія замовлень клієнта | `ROLE_CLIENT` |
| `GET` | `/orders/employee` | Перегляд замовлень (для працівника) | `ROLE_EMPLOYEE` |
| `POST` | `/orders/{id}/confirm` | Підтвердити замовлення | `ROLE_EMPLOYEE` |
| `POST` | `/orders/{id}/decline` | Відхилити замовлення | `ROLE_EMPLOYEE` |

### Управління книгами
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/employee/books` | Список книг (адмін панель) | `ROLE_EMPLOYEE` |
| `POST` | `/employee/books/save` | Додати або оновити книгу | `ROLE_EMPLOYEE` |
| `POST` | `/employee/books/delete/{id}` | Видалити книгу | `ROLE_EMPLOYEE` |
| `GET` | `/employee/books/cancel` | Скасувати редагування | `ROLE_EMPLOYEE` |

### Управління користувачами
| Метод | Шлях | Опис | Доступ |
|-------|------|------|--------|
| `GET` | `/employee/users` | Список користувачів | `ROLE_EMPLOYEE` |
| `POST` | `/employee/users/add-employee` | Додати нового працівника | `ROLE_EMPLOYEE` |
| `POST` | `/employee/users/client/status` | Блокування/Розблокування клієнта | `ROLE_EMPLOYEE` |


## Тестові дані (SQL)
У файлі `src/main/resources/sql/sql.sql` вже підготовлені дані для тестування. Ви можете використовувати наступних користувачів для входу:

### Працівники
| Email | Пароль |
|-------|--------|
| `john.doe@email.com` | `pass123` |
| `jane.smith@email.com` | `abc456` |
| `bob.jones@email.com` | `qwerty789` |

### Клієнти
| Email | Пароль | Баланс |
|-------|--------|--------|
| `client1@example.com` | `password123` | 1000.00 |
| `client2@example.com` | `securepass` | 1500.50 |
| `client3@example.com` | `abc123` | 800.75 |

*Повний список користувачів можна знайти у файлі `sql.sql`.*
